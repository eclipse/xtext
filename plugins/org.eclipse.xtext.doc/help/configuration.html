<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Configuration</title>
<link href="book.css" rel="stylesheet" type="text/css">
<meta content="DocBook XSL Stylesheets V1.75.1" name="generator">
<link rel="home" href="index.html" title="Xtext User Guide">
<link rel="up" href="index.html" title="Xtext User Guide">
<link rel="prev" href="CommonTerminals.html" title="Common Terminals">
<link rel="next" href="dependencyInjection.html" title="Dependency Injection in Xtext with Google Guice">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<h1 xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0">Configuration</h1>
<div class="section" title="The Generator">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both">
<a name="generator"></a>The Generator</h2>
</div>
</div>
</div>
<p>Xtext provides lots of generic implementations for your language&rsquo;s
				infrastructure but also uses code generation to generate some of the 
				components. Those generated components are for instance the parser, the 
				serializer, the inferred Ecore model (if any) and a couple of convenient base classes for 
				content assist, etc.</p>
<p>The generator also contributes to shared project resources such as the 

				<span class="emphasis"><em>plugin.xml</em></span>, 
				<span class="emphasis"><em>MANIFEST.MF</em></span> and the 
				<a class="link" href="dependencyInjection.html#guicemodules" title="The Module API">Guice modules</a>.
			</p>
<p>Xtext&rsquo;s generator leverages 
				<a class="link" href="MWE2.html" title="MWE2">MWE2 &ndash; the modeling workflow engine</a> 
				from EMFT to configure the generator.
			</p>
<div class="section" title="A Short Introduction to MWE2">
<div class="titlepage">
<div>
<div>
<h3 class="title">
<a name="short_intro_to_mwe"></a>A Short Introduction to MWE2</h3>
</div>
</div>
</div>
<p>MWE2 allows to compose object graphs declaratively in a very compact manner. The nice thing about it is that it just 
					instantiates Java classes and the configuration is done through public setter and adder methods as one is used to 
					from Java Beans encapsulation principles. An in-depth documentation can be found in the chapter 
					<a class="link" href="MWE2.html" title="MWE2">MWE2</a>.
				</p>
<p>Given the following simple Java class (POJO):</p>
<div class="literallayout">
<p>
<code class="code">package&nbsp;com.mycompany;<br>
&nbsp;&nbsp;<br>
public&nbsp;class&nbsp;Person&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;private&nbsp;String&nbsp;name;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;public&nbsp;void&nbsp;setName(String&nbsp;name)&nbsp;{&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;this.name&nbsp;=&nbsp;name;<br>
&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;private&nbsp;final&nbsp;List&lt;Person&gt;&nbsp;children&nbsp;=&nbsp;new&nbsp;ArrayList&lt;Person&gt;();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;public&nbsp;void&nbsp;addChild(Person&nbsp;child)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;this.children.add(child);<br>
&nbsp;&nbsp;}<br>
}<br>
&nbsp;&nbsp;<br>

</code>
</p>
</div>
<p>One can create a family tree with MWE2 easily by describing it in a declarative manner 
					without writing a single line of Java code and without the need to compile classes:</p>
<div class="literallayout">
<p>
<code class="code">module&nbsp;com.mycompany.CreatePersons<br>

<br>
Person&nbsp;{<br>
	name&nbsp;=&nbsp;"Grandpa"<br>
	child&nbsp;=&nbsp;{<br>
		name&nbsp;=&nbsp;"Father"<br>
		child&nbsp;=&nbsp;{<br>
			name&nbsp;=&nbsp;"Son"<br>
		}<br>
	}<br>
}<br>

<br>

</code>
</p>
</div>
<p>These couple of lines will, when interpreted by MWE2, result in an 
					object tree consisting of three instances of 
					<span class="emphasis"><em>com.mycompany.Person</em></span>.
					The interpreter will basically do the same as the following 
					<span class="emphasis"><em>main</em></span> method: 
				</p>
<div class="literallayout">
<p>
<code class="code">package&nbsp;com.mycompany;<br>

<br>
public&nbsp;class&nbsp;CreatePersons&nbsp;{<br>
	public&nbsp;static&nbsp;void&nbsp;main(String[]&nbsp;args)&nbsp;{<br>
		Person&nbsp;grandpa&nbsp;=&nbsp;new&nbsp;Person();<br>
		grandpa.setName("Grandpa");<br>
		Person&nbsp;father&nbsp;=&nbsp;new&nbsp;Person();<br>
		father.setName("Father");<br>
		grandpa.addChild(father);<br>
		Person&nbsp;son&nbsp;=&nbsp;new&nbsp;Person();<br>
		son.setName("Son");<br>
		father.addChild(son);<br>
	}<br>
}<br>

<br>

</code>
</p>
</div>
<p>
					
</p>
<div class="mediaobject">
<img src="images/family_tree.png"></div>
<p> 
				
</p>
<p>The root element is a class-name following the Java classpath visibility rules. As the module is a sibling to the class

					<span class="emphasis"><em>com.mycompany.Person</em></span> it is not necessary to use use fully qualified name. There are other packages implicitly imported
					into this workflow as well to make it convenient to instantiate actual workflows and components, but these ones are covered 
					in depth in the appropriate 
					<a class="link" href="MWE2.html" title="MWE2">chapter</a>. The constructed objects are furthermore configured according to the declaration 
					in the module, e.g. a second instance of Person will be created and added to the list of children of &ldquo;Grandpa&rdquo; while the third 
					person &ndash; the class is inferred from the assigned feature &ndash; becomes a child of &ldquo;Father&rdquo;. All three instances will have 
					their respective 
					<span class="emphasis"><em>name</em></span> assigned via a reflective invocation 
					<span class="emphasis"><em>setName</em></span>. If one wants to add another child to &ldquo;Father&rdquo;, she
					can simply repeat the child assignment:
				</p>
<div class="literallayout">
<p>
<code class="code">child&nbsp;=&nbsp;com.mycompany.Person&nbsp;{<br>
	name&nbsp;=&nbsp;"Father"<br>
	child&nbsp;=&nbsp;{<br>
		name&nbsp;=&nbsp;"Son"<br>
	}<br>
	child&nbsp;=&nbsp;{<br>
		name&nbsp;=&nbsp;"Daughter"<br>
	}<br>
}<br>

<br>

</code>
</p>
</div>
<p>As you can see in the example above MWE2 can be used to instantiate arbitrary Java object models without any dependency or
					limitation to MWE2 specific implementations. This is conceptually very close to the dependency injection mechanism and 
					the XML language in the 
					<a class="ulink" href="http://www.springframework.org" target="_new">Spring Framework</a>. 
				</p>
<p>
					
<span class="bold"><strong>Tip</strong></span>

					<span class="italic">Whenever you are in an *.mwe2 file and wonder what kind of configuration the underlying component may accept:</span>

					<span class="italic">Just use the Content Assist in the MWE2 Editor or navigate directly to the declaration of the underlying Java</span> 

					<span class="italic">implementation by means of F3 (Go To Declaration).</span>
				
</p>
<p>This is the basic idea of the MWE2 language. There are of course a couple of additional concepts and features in the 
					language and we also have not yet talked about the runtime workflow model. Please refer to the dedicated MWE2 

					<a class="link" href="MWE2.html" title="MWE2">reference documentation</a> for additional information.
				</p>
</div>
<div class="section" title="General Architecture">
<div class="titlepage">
<div>
<div>
<h3 class="title">
<a name="GeneralArchitecture"></a>General Architecture </h3>
</div>
</div>
</div>
<p>Of course a generator in Xtext is not composed of fathers and sons, but of so called language configurations. 
					For each language configuration a URI pointing to 
					its grammar file and the file extensions for the DSL must be provided. 
					In addition, a language is configured with a list of 

					<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.generator/src/org/eclipse/xtext/generator/IGeneratorFragment.java?root=Modeling_Project&view=co" target="_new">IGeneratorFragment</a>s.
					The whole generator is composed of theses fragments. We have fragments for generating parsers, the serializer, the EMF code, 
					the outline view, etc. 
				</p>
<p>
					
</p>
<div class="mediaobject">
<img src="images/generator-structure.png"></div>
<p>
				
</p>
<div class="section" title="Generator Fragments">
<div class="titlepage">
<div>
<div>
<h4 class="title">
<a name="generator_fragment"></a>Generator Fragments</h4>
</div>
</div>
</div>
<p>Each fragment gets the grammar of the language as an EMF model passed in. A fragment is able to generate code in one 
						of the configured locations and contribute to several shared artifacts. The main interface 

						<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.generator/src/org/eclipse/xtext/generator/IGeneratorFragment.java?root=Modeling_Project&view=co" target="_new">IGeneratorFragment</a> is supported by a convenient 
						abstract base class 
						<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.generator/src/org/eclipse/xtext/generator/AbstractGeneratorFragment.java?root=Modeling_Project&view=co" target="_new">AbstractGeneratorFragment</a>, which 
						by default delegates to an Xpand template with the same qualified name as the class and delegates some of the 
						calls to Xpand template definitions.
					</p>
<p>We suggest to have a look at the fragment we have written for label providers (
						<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.generator/src/org/eclipse/xtext/ui/generator/labeling/LabelProviderFragment.java?root=Modeling_Project&view=co" target="_new">LabelProviderFragment</a>). It is pretty trivial and at the same time uses the most important call backs. In addition, the structure is not cluttered with too much extra noise so that the whole package can serve as a template to write your own fragment.
					</p>
</div>
<div class="section" title="Configuration">
<div class="titlepage">
<div>
<div>
<h4 class="title">
<a name="Configuration"></a>Configuration</h4>
</div>
</div>
</div>
<p>As already explained we use MWE2 from EMFT in order to instantiate, configure and execute this structure of components. 
						In the following we see an exemplary Xtext generator configuration written in MWE2 configuration code:  </p>
<div class="literallayout">
<p>
<code class="code">module&nbsp;org.xtext.example.MyDsl<br>

<br>
import&nbsp;org.eclipse.emf.mwe.utils.*<br>
import&nbsp;org.eclipse.xtext.generator.*<br>
import&nbsp;org.eclipse.xtext.ui.generator.*<br>

<br>
var&nbsp;grammarURI&nbsp;=&nbsp;"classpath:/org/xtext/example/MyDsl.xtext"<br>
var&nbsp;file.extensions&nbsp;=&nbsp;"mydsl"<br>
var&nbsp;projectName&nbsp;=&nbsp;"org.xtext.example.mydsl"<br>
var&nbsp;runtimeProject&nbsp;=&nbsp;"../${projectName}"<br>

<br>
Workflow&nbsp;{<br>
	bean&nbsp;=&nbsp;StandaloneSetup&nbsp;{<br>
		platformUri&nbsp;=&nbsp;"${runtimeProject}/.."<br>
	}<br>

<br>
	component&nbsp;=&nbsp;DirectoryCleaner&nbsp;{<br>
		directory&nbsp;=&nbsp;"${runtimeProject}/src-gen"<br>
	}<br>

<br>
	component&nbsp;=&nbsp;DirectoryCleaner&nbsp;{<br>
		directory&nbsp;=&nbsp;"${runtimeProject}.ui/src-gen"<br>
	}<br>

<br>
	component&nbsp;=&nbsp;Generator&nbsp;{<br>
		pathRtProject&nbsp;=&nbsp;runtimeProject<br>
		pathUiProject&nbsp;=&nbsp;"${runtimeProject}.ui"<br>
		projectNameRt&nbsp;=&nbsp;projectName<br>
		projectNameUi&nbsp;=&nbsp;"${projectName}.ui"<br>

<br>
		language&nbsp;=&nbsp;{<br>
			uri&nbsp;=&nbsp;grammarURI<br>
			fileExtensions&nbsp;=&nbsp;file.extensions<br>

<br>
			//&nbsp;Java&nbsp;API&nbsp;to&nbsp;access&nbsp;grammar&nbsp;elements<br>
			fragment&nbsp;=&nbsp;grammarAccess.GrammarAccessFragment&nbsp;{}<br>

<br>
			/*&nbsp;more&nbsp;fragments&nbsp;to&nbsp;configure&nbsp;the&nbsp;language&nbsp;*/<br>
			...<br>
		}<br>
	}<br>
}<br>

<br>

</code>
</p>
</div>
<p>Here the root element is 
						<span class="emphasis"><em>Workflow</em></span> and is part of the very slim runtime model shipped with MWE2. It accepts 

						<span class="italic">bean</span> s and 
						<span class="italic">component</span> s. The 
						<span class="emphasis"><em>var</em></span> declaration is a first class concept of MWE2&rsquo;s configuration language 
						and defines the interface of the module. They allow to externalize some common configuration parameters. This 
						comes especially handy in String variables where one can easily use 
						<span class="emphasis"><em>${variable}</em></span> to concatenate values. 
					</p>
<p>The method 
						<span class="emphasis"><em>Workflow.addBean(Object)</em></span> does nothing but provides a means to apply global side-effects, which 
						unfortunately is required sometimes. In this example we do a so called 
						<span class="italic">EMF stand-alone setup</span>. This class 
						initializes a bunch of things for a non-OSGi environment that are otherwise configured by means of extension points, 
						e.g. it allows to populate EMF&rsquo;s singletons like the 
						<span class="emphasis"><em>EPackage.Registry</em></span>.
					</p>
<p>Following the 
						<span class="emphasis"><em>bean</em></span> assignment there are three 
						<span class="emphasis"><em>component</em></span> elements. The 
						<span class="emphasis"><em>Workflow.addComponent()</em></span> method 
						accepts instances of 
						<span class="emphasis"><em>IWorkflowComponent</em></span>, which is the primary concept of MWE2&rsquo;s workflow model. Xtext&rsquo;s generator 
						itself is an instance of 
						<span class="emphasis"><em>IWorkflowComponent</em></span> and can therefore be used within MWE2 workflows. 
					</p>
<p>There are two fragments 
						<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.generator/src/org/eclipse/xtext/generator/ImplicitRuntimeFragment.java?root=Modeling_Project&view=co" target="_new">ImplicitRuntimeFragment</a> and 

						<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.generator/src/org/eclipse/xtext/ui/generator/ImplicitUiFragment.java?root=Modeling_Project&view=co" target="_new">ImplicitUiFragment</a> will be called implicitly if 
						the required paths and project names are set. They take care of common defaults.  
					</p>
</div>
</div>
<div class="section" title="Standard Generator Fragments">
<div class="titlepage">
<div>
<div>
<h3 class="title">
<a name="StandardGeneratorFragments"></a>Standard Generator Fragments</h3>
</div>
</div>
</div>
<p>In the following table the most important standard generator fragments are listed. Please refer to the Javadocs for more detailed documentation.</p>
<table id="N10D39">
<tr>
						
<th>Class</th>
						<th>Generated Artifacts</th>
						<th>Related Documentation</th>
					
</tr>
<tr>
						
<td>
							<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.generator/src/org/eclipse/xtext/generator/ecore/EcoreGeneratorFragment.java?root=Modeling_Project&view=co" target="_new">EcoreGeneratorFragment</a>
						</td>
						<td>EMF code for generated models</td>
						<td>
							<a class="link" href="metamodelInference.html" title="Ecore Model Inference">Model inference</a>
						</td>
					
</tr>
<tr>
						
<td>
							<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.generator/src/org/eclipse/xtext/generator/parser/antlr/XtextAntlrGeneratorFragment.java?root=Modeling_Project&view=co" target="_new">XtextAntlrGeneratorFragment</a>
						</td>
						<td>ANTLR grammar, parser, lexer and related services</td>
						<td></td>
					
</tr>
<tr>
						
<td>
							<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.generator/src/org/eclipse/xtext/generator/grammarAccess/GrammarAccessFragment.java?root=Modeling_Project&view=co" target="_new">GrammarAccessFragment</a>
						</td>
						<td>Access to the grammar</td>
						<td></td>
					
</tr>
<tr>
						
<td>
							<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.generator/src/org/eclipse/xtext/generator/resourceFactory/ResourceFactoryFragment.java?root=Modeling_Project&view=co" target="_new">ResourceFactoryFragment</a>
						</td>
						<td>EMF resource factory</td>
						<td>
							<a class="link" href="xtext_resource.html" title="XtextResource Implementation">Xtext Resource</a>
						</td>
					
</tr>
<tr>
						
<td>
							<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.generator/src/org/eclipse/xtext/generator/parseTreeConstructor/ParseTreeConstructorFragment.java?root=Modeling_Project&view=co" target="_new">ParseTreeConstructorFragment</a>
						</td>
						<td>Model-to-text serialization</td>
						<td>
							<a class="link" href="serialization.html" title="Serialization">Serialization</a>
						</td>
					
</tr>
<tr>
						
<td>
							<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.generator/src/org/eclipse/xtext/generator/scoping/ImportNamespacesScopingFragment.java?root=Modeling_Project&view=co" target="_new">ImportNamespacesScopingFragment</a>
						</td>
						<td>Index-based scoping</td>
						<td>
							<a class="link" href="scoping.html#index_based" title="Global Scopes Based On External Configuration (e.g. Classpath-Based)">Index-based namespace scoping</a>
						</td>
					
</tr>
<tr>
						
<td>
							<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.generator/src/org/eclipse/xtext/generator/validation/JavaValidatorFragment.java?root=Modeling_Project&view=co" target="_new">JavaValidatorFragment</a>
						</td>
						<td>Model validation</td>
						<td>
							<a class="link" href="validation.html#custom_validation" title="Custom Validation">Model validation</a>
						</td>
					
</tr>
<tr>
						
<td>
							<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.generator/src/org/eclipse/xtext/generator/formatting/FormatterFragment.java?root=Modeling_Project&view=co" target="_new">FormatterFragment</a>
						</td>
						<td>Code formatter</td>
						<td>
							<a class="link" href="formatting.html#declarativeformatter" title="Declarative Formatter">Declarative formatter</a>
						</td>
					
</tr>
<tr>
						
<td>
							<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.generator/src/org/eclipse/xtext/ui/generator/labeling/LabelProviderFragment.java?root=Modeling_Project&view=co" target="_new">LabelProviderFragment</a>
						</td>
						<td>Label provider</td>
						<td>
							<a class="link" href="IDEConcepts.html#labelProvider" title="Label Provider">Label provider</a>
						</td>
					
</tr>
<tr>
						
<td>
							<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.generator/src/org/eclipse/xtext/ui/generator/outline/OutlineNodeAdapterFactoryFragment.java?root=Modeling_Project&view=co" target="_new">OutlineNodeAdapterFactoryFragment</a>
						</td>
						<td>Outline view configuration</td>
						<td>
							<a class="link" href="outline.html" title="Outline View">Outline</a>
						</td>
					
</tr>
<tr>
						
<td>
							<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.generator/src/org/eclipse/xtext/ui/generator/outline/TransformerFragment.java?root=Modeling_Project&view=co" target="_new">TransformerFragment</a>
						</td>
						<td>Outline view configuration</td>
						<td>
							<a class="link" href="outline.html" title="Outline View">Outline</a>
						</td>
					
</tr>
<tr>
						
<td>
							<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.generator/src/org/eclipse/xtext/ui/generator/contentAssist/JavaBasedContentAssistFragment.java?root=Modeling_Project&view=co" target="_new">JavaBasedContentAssistFragment</a>
						</td>
						<td>Java-based content assist</td>
						<td>
							<a class="link" href="contentAssist.html" title="Content Assist">Content assist</a>
						</td>
					
</tr>
<tr>
						
<td>
							<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.generator/src/org/eclipse/xtext/generator/parser/antlr/XtextAntlrUiGeneratorFragment.java?root=Modeling_Project&view=co" target="_new">XtextAntlrUiGeneratorFragment</a>
						</td>
						<td>Content assist helper based on ANTLR</td>
						<td>
							<a class="link" href="contentAssist.html" title="Content Assist">Content assist</a>
						</td>
					
</tr>
<tr>
						
<td>
							<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.generator/src/org/eclipse/xtext/ui/generator/projectWizard/SimpleProjectWizardFragment.java?root=Modeling_Project&view=co" target="_new">SimpleProjectWizardFragment</a>
						</td>
						<td>New project wizard</td>
						<td>
							<a class="link" href="projectwizard.html" title="Project Wizard">Project wizard</a>
						</td>
					
</tr>
</table>
</div>
</div>
</body>
</html>

<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Linking</title>
<link href="book.css" rel="stylesheet" type="text/css">
<meta content="DocBook XSL Stylesheets V1.75.1" name="generator">
<link rel="home" href="index.html" title="Xtext User Guide">
<link rel="up" href="RuntimeConcepts.html" title="Runtime Concepts">
<link rel="prev" href="validation.html" title="Validation">
<link rel="next" href="scoping.html" title="Scoping">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<h1 xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0">Linking</h1>
<p>The linking feature allows for specification of cross references within an Xtext grammar.
				The following things are needed for the linking:</p>
<div class="orderedlist">
<ol class="orderedlist" type="1">
<li class="listitem">
<p>declaration of a crosslink in the grammar (at least in the Ecore model)</p>
</li>
<li class="listitem">
<p>specification of linking semantics (usually provided via the 
						<a class="link" href="scoping.html" title="Scoping">scoping API</a>)
					</p>
</li>
</ol>
</div>
<div class="section" title="Declaration of crosslinks">
<div class="titlepage">
<div>
<div>
<h3 class="title">
<a name="Declarationofcrosslinks"></a>Declaration of crosslinks</h3>
</div>
</div>
</div>
<p>In the grammar a cross reference is specified using square brackets.</p>
<div class="literallayout">
<p>
<code class="code">CrossReference&nbsp;:<br>
&nbsp;&nbsp;'['&nbsp;type=ReferencedEClass&nbsp;('|'&nbsp;terminal=CrossReferenceableTerminal)?&nbsp;']'<br>
;<br>

<br>

</code>
</p>
</div>
<p>Example:</p>
<div class="literallayout">
<p>
<code class="code">ReferringType&nbsp;:<br>
&nbsp;&nbsp;'ref'&nbsp;referencedObject=[Entity|STRING]<br>
;<br>

<br>

</code>
</p>
</div>
<p>The 
					<a class="link" href="metamodelInference.html" title="Ecore model inference">Ecore model inference</a> would create an 
					<span class="emphasis"><em>EClass</em></span> 
					<span class="emphasis"><em>ReferringType</em></span> with an 

					<span class="emphasis"><em>EReference</em></span> 
					<span class="emphasis"><em>referencedObject</em></span> of type 
					<span class="emphasis"><em>Entity</em></span> (
					<span class="emphasis"><em>containment=false</em></span>). The referenced object would 
					be identified either by a 
					<span class="emphasis"><em>STRING</em></span> and the surrounding information in the current context 
					(see 
					<a class="link" href="scoping.html" title="Scoping">scoping</a>). If you do not use 
					<span class="emphasis"><em>generate</em></span> but 
					<span class="emphasis"><em>import</em></span> an existing Ecore model, 
					the class 
					<span class="emphasis"><em>ReferringType</em></span> (or one of its super types) would need to have an 
					<span class="emphasis"><em>EReference</em></span> of type 

					<span class="emphasis"><em>Entity</em></span> (or one of its super types) declared. Also the 
					<span class="emphasis"><em>EReference</em></span>'s containment and container 
					properties needs to be set to 
					<span class="emphasis"><em>false</em></span>. 
				</p>
</div>
<div class="section" title="Default runtime behavior &ndash; Lazy Linking">
<div class="titlepage">
<div>
<div>
<h3 class="title">
<a name="DefaultruntimebehaviorLazyLinking"></a>Default runtime behavior &ndash; Lazy Linking</h3>
</div>
</div>
</div>
<p>Xtext uses lazy linking by default and we encourage users to stick to this because it provides a 
					many advantages. One of which is improved performance in all scenarios where you don&rsquo;t have to load 
					the whole closure of all transitively referenced resources. Furthermore it automatically solves 
					situations where one link relies on other links. Though cyclic linking dependencies are not 
					supported by Xtext at all. </p>
<p>When parsing a given input string, say</p>
<div class="literallayout">
<p>
<code class="code">ref&nbsp;Entity01<br>

</code>
</p>
</div>
<p>the 
					<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext/src/org/eclipse/xtext/linking/lazy/LazyLinker.java?root=Modeling_Project&view=co" target="_new">LazyLinker</a> first creates an EMF proxy and 
					assigns it to the corresponding 
					<span class="emphasis"><em>EReference</em></span>. In EMF a proxy is described by a URI, which points to the 
					real 
					<span class="emphasis"><em>EObject</em></span>. In the case of lazy linking the stored URI comprises of the context information given 
					at parse time, which is the 
					<span class="emphasis"><em>EObject</em></span> containing the cross reference, the actual 
					<span class="emphasis"><em>EReference</em></span>, the 
					index (in case it&rsquo;s a multi-valued cross reference) and the string which represented the cross link 
					in the concrete syntax. The latter usually corresponds to the name of the referenced 
					<span class="emphasis"><em>EObject</em></span>. 
					In EMF a URI consists of information about the resource the 
					<span class="emphasis"><em>EObject</em></span> is contained in as well as a so 
					called fragment part, which is used to find the 
					<span class="emphasis"><em>EObject</em></span> within that resource. When an  EMF proxy 
					is resolved, the current 
					<span class="emphasis"><em>ResourceSet</em></span> is asked. The resource set uses the first part to obtain 
					(i.e. load if it is not already loaded) the resource. Then the resource is asked to return the 

					<span class="emphasis"><em>EObject</em></span> based on the fragment in the URI. The actual cross reference resolution is done by 

					<span class="emphasis"><em>LazyLinkingResource.getEObject(String)</em></span> which receives the fragment and delegates to the implementation 
					of the 
					<span class="emphasis"><em>ILinkingService</em></span>. The default implementation in turn delegates to the 
					<a class="link" href="scoping.html" title="Scoping">scoping API</a>.
				</p>
<p>A simple implementation of the linking service (the 

					<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext/src/org/eclipse/xtext/linking/impl/DefaultLinkingService.java?root=Modeling_Project&view=co" target="_new">DefaultLinkingService</a>) is shipped with Xtext 
					and used for any grammar per default. Usually any necessary customization of the linking behavior 
					can best be described using the 
					<a class="link" href="scoping.html" title="Scoping">scoping API</a>.
				</p>
</div>
</body>
</html>

<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>IDE concepts</title>
<link href="book.css" rel="stylesheet" type="text/css">
<meta content="DocBook XSL Stylesheets V1.75.1" name="generator">
<link rel="home" href="index.html" title="Xtext User Guide">
<link rel="up" href="index.html" title="Xtext User Guide">
<link rel="prev" href="MWE2SyntaxReference.html" title="Syntax Reference">
<link rel="next" href="contentAssist.html" title="Content Assist">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<h1 xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0">IDE concepts</h1>
<p>For the following part we will refer to a concrete example grammar in order to explain certain aspect 
			of the UI more clearly. The used example grammar is as follows:</p>
<div class="literallayout">
<p>
<code class="code">grammar&nbsp;org.eclipse.text.documentation.Sample&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;org.eclipse.xtext.common.Terminals<br>

<br>
generate&nbsp;gen&nbsp;'http://www.eclipse.org/xtext/documentation/Sample'<br>

<br>
Model&nbsp;:<br>
&nbsp;&nbsp;"model"&nbsp;intAttribute=INT&nbsp;(stringDescription=STRING)?&nbsp;"{"&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rules&nbsp;+=&nbsp;AbstractRule)*&nbsp;<br>
&nbsp;&nbsp;"}"&nbsp;<br>
;<br>

<br>
AbstractRule:<br>
&nbsp;&nbsp;RuleA&nbsp;|&nbsp;RuleB<br>
;<br>

<br>
RuleA&nbsp;:<br>
&nbsp;&nbsp;&nbsp;"RuleA"&nbsp;"("&nbsp;name&nbsp;=&nbsp;ID&nbsp;")"&nbsp;;<br>

<br>
RuleB&nbsp;return&nbsp;gen::CustomType:<br>
&nbsp;&nbsp;&nbsp;"RuleB"&nbsp;"("&nbsp;ruleA&nbsp;=&nbsp;[RuleA]&nbsp;")"&nbsp;;<br>

<br>

</code>
</p>
</div>
<p></p>
<div class="section" title="Label Provider">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both">
<a name="labelProvider"></a>Label Provider</h2>
</div>
</div>
</div>
<p>There are various places in the UI in which model elements have to be presented to the user: In the 

				<a class="link" href="outline.html" title="Outline View">outline view</a>, in 
				<a class="link" href="hyperlinking.html" title="Hyperlinking">hyper links</a>, in 
				<a class="link" href="contentAssist.html" title="Content Assist">content proposals</a>, 
				find dialogs etc. Xtext allows to customize each of these appearances by individual 
				<span class="emphasis"><em>ILabelProviders</em></span>. 
			</p>
<p>An 
				<span class="emphasis"><em>ILabelProvider</em></span> has two methods: 
				<span class="emphasis"><em>getText(Object)</em></span> returns the text in an object&rsquo;s label, 
				while 
				<span class="emphasis"><em>getImage(Object)</em></span> returns the icon. In addition, the Eclipse UI framework offers the 

				<span class="emphasis"><em>IStyledLabelProvider</em></span>, which returns a styled string (i.e. with custom fonts, colors etc.) in the 

				<span class="emphasis"><em>getStyledText(Object)</em></span> method. 
			</p>
<p>Almost all label providers in the Xtext framework inherit from the base class 

				<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.ui/src/org/eclipse/xtext/ui/label/AbstractLabelProvider.java?root=Modeling_Project&view=co" target="_new">AbstractLabelProvider</a> which unifies both 
				approaches. Subclasses can either return a styled string or a string in the 
				<span class="emphasis"><em>doGetText(Object)</em></span> method. 
				The framework will automatically convert it to a styled text (with default styles) or to a plain text 
				in the respective methods. 
			</p>
<p>Dealing with images can be cumbersome, too, as image handles tend to be scarce system resources. 
				The 
				<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.ui/src/org/eclipse/xtext/ui/label/AbstractLabelProvider.java?root=Modeling_Project&view=co" target="_new">AbstractLabelProvider</a> helps you managing 
				the images: In your implementation of 
				<span class="emphasis"><em>doGetImage(Object)</em></span> you can as well return an 
				<span class="emphasis"><em>Image</em></span> or a string, 
				representing a path in the 
				<span class="emphasis"><em>icons/</em></span> folder of the containing plug-in. This path is actually 
				configurable by Google Guice. Have a look at the 

				<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.ui/src/org/eclipse/xtext/ui/PluginImageHelper.java?root=Modeling_Project&view=co" target="_new">PluginImageHelper</a> to learn about the 
				customizing possibilities.
			</p>
<p>If you have the 

				<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.generator/src/org/eclipse/xtext/ui/generator/labeling/LabelProviderFragment.java?root=Modeling_Project&view=co" target="_new">LabelProviderFragment</a> in the 
				list of generator fragments in the MWE2 workflow for your language, it will automatically create 
				stubs and bindings for an 
				<a class="link" href="IDEconcepts.html#EObjectLabelProvider" title="Label providers for EObjects">
					<span class="emphasis"><em>EObjectLabelProvider</em></span>
				</a> and an 

				<a class="link" href="IDEconcepts.html#DescriptionLabelProvider" title="Label providers for index entries">
					<span class="emphasis"><em>DescriptionLabelProvider</em></span>
				</a> which you can implement by manually. 
			</p>
<div class="section" title="Label providers for EObjects">
<div class="titlepage">
<div>
<div>
<h3 class="title">
<a name="EObjectLabelProvider"></a>Label providers for EObjects</h3>
</div>
</div>
</div>
<p>The first set of label providers refers to actually loaded and thereby available model elements. 
					By default, Xtext binds the 
					<span class="emphasis"><em>DefaultEObjectLabelProvider</em></span> to all use cases, but you can change the 
					binding individually for the Outline, Content Assist or other places. For that purpose, there is a 
					so called 
					<span class="emphasis"><em>binding annotation</em></span> for each use case. For example, to use a custom 

					<span class="emphasis"><em>MyContentAssistLabelProvider</em></span> to display elements in the content assist, you have to override
				</p>
<div class="literallayout">
<p>
<code class="code">@Override<br>
public&nbsp;void&nbsp;configureContentProposalLabelProvider(Binder&nbsp;binder)&nbsp;{<br>
&nbsp;&nbsp;binder.bind(ILabelProvider.class)<br>
&nbsp;&nbsp;&nbsp;&nbsp;.annotatedWith(ContentProposalLabelProvider.class)<br>
&nbsp;&nbsp;&nbsp;&nbsp;.to(MyContentAssistLabelProvider.class);<br>
}<br>

<br>
p.in&nbsp;your&nbsp;language's&nbsp;UI&nbsp;module.&nbsp;<br>

<br>

</code>
</p>
</div>
<p>If your grammar uses an imported 
					<span class="emphasis"><em>EPackage</em></span>, there may be an existing 
					<span class="emphasis"><em>.edit</em></span> plug-in generated 
					by EMF that also provides label providers for model elements. To use this as a fallback, your label 
					provider should call the constructor with the 
					delegate parameter and use DI for the initialization, e.g.
				</p>
<div class="literallayout">
<p>
<code class="code">public&nbsp;class&nbsp;MyLabelProvider&nbsp;{<br>
	@Inject	<br>
	public&nbsp;MyLabelProvider(AdapterFactoryLabelProvider&nbsp;delegate)&nbsp;{<br>
		super(delegate);<br>
	}<br>
	...<br>
}&nbsp;&nbsp;<br>

<br>

</code>
</p>
</div>
<div class="section" title="DefaultEObjectLabelProvider">
<div class="titlepage">
<div>
<div>
<h4 class="title">
<a name="DefaultEObjectLabelProvider"></a>DefaultEObjectLabelProvider</h4>
</div>
</div>
</div>
<p>The default implementation of the 
						<span class="emphasis"><em>LabelProvider</em></span> interface utilizes the polymorphic dispatcher idiom 
						to implement an external visitor as the requirements of the LabelProvider are kind of a best match for 
						this pattern. It comes down to the fact that the only thing you need to do is to implement a method 
						that matches a specific signature. It either provides a image filename or the text to be used to 
						represent your model element. Have a look at following example to get a more detailed idea about 
						the 
						<span class="emphasis"><em>DefaultEObjectLabelProvider</em></span>.
					</p>
<div class="literallayout">
<p>
<code class="code">public&nbsp;class&nbsp;SampleLabelProvider&nbsp;extends&nbsp;DefaultLabelProvider&nbsp;{<br>

<br>
&nbsp;&nbsp;String&nbsp;text(RuleA&nbsp;rule)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;"Rule:&nbsp;"&nbsp;+&nbsp;rule.getName();<br>
&nbsp;&nbsp;}<br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;String&nbsp;image(RuleA&nbsp;rule)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;"ruleA.gif";<br>
&nbsp;&nbsp;}<br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;String&nbsp;image(RuleB&nbsp;rule)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;"ruleB.gif";<br>
&nbsp;&nbsp;}<br>
}<br>
	
<br>

</code>
</p>
</div>
<p>What is especially nice about the default implementation is the actual reason for its class 
						name: It provides very reasonable defaults. To compute the label for a certain model element, it will 
						at first have a look for an EAttribute 
						<span class="emphasis"><em>name</em></span> and try to use this one. If it cannot find such a feature, 
						it will try to use the first feature, that can be used best as a label. At worst it will return the 
						class name of the model element, which is kind of unlikely to happen.
					</p>
<p>You can a also customize error handling by overriding the methods 
						<span class="emphasis"><em>handleTextError()</em></span> or 

						<span class="emphasis"><em>handleImageError()</em></span>.
					</p>
</div>
</div>
<div class="section" title="Label providers for index entries">
<div class="titlepage">
<div>
<div>
<h3 class="title">
<a name="DescriptionLabelProvider"></a>Label providers for index entries</h3>
</div>
</div>
</div>
<p>Xtext maintains an index of all model elements to allow quick searching and linking without loading 
					the referenced resource (See the chapter on 
					<a class="link" href="scoping.html#index_based" title="Global Scopes based on external configuration (e.g. classpath-based)">index based scopes</a> for details). The 
					elements from this index also appear in some UI contexts, e.g. in the 
					<span class="emphasis"><em>Find model elements</em></span> dialog or 
					in the 
					<span class="emphasis"><em>Find references</em></span> view. For reasons of scalability, the UI should not automatically load 
					resources, so we need another implementation of a label provider that works with the elements from the 
					index, i.e. 
					<span class="emphasis"><em>IResourceDescription</em></span>, IEObjectDescription_, and 
					<span class="emphasis"><em>IReferenceDescription</em></span>.
				</p>
<p>The default implementation of this service is the 

					<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.ui/src/org/eclipse/xtext/ui/label/DefaultDescriptionLabelProvider.java?root=Modeling_Project&view=co" target="_new">DefaultDescriptionLabelProvider</a>. It employs the 
					same polymorphic dispatch mechanism as the 
					<a class="link" href="IDEconcepts.html#DefaultEObjectLabelProvider" title="DefaultEObjectLabelProvider">DefaultEObjectLabelProvider</a>. 
					The default text of an 
					<span class="emphasis"><em>EObjectDescription</em></span> is its indexed name. The image is resolved by dispatching 
					to 
					<span class="emphasis"><em>image(EClass)</em></span> with the 
					<span class="emphasis"><em>EClass</em></span> of the described object. This is likely the only method you want 
					to override. 
					<span class="emphasis"><em>IResourceDescriptions</em></span> will be represented with their path and the icon registered for 
					your language&rsquo;s editor. 
				</p>
<p>To have a custom description label provider, make sure it is bound in your UI module:</p>
<div class="literallayout">
<p>
<code class="code">public&nbsp;void&nbsp;configureResourceUIServiceLabelProvider(Binder&nbsp;binder)&nbsp;{<br>
&nbsp;&nbsp;binder.bind(ILabelProvider.class)<br>
&nbsp;&nbsp;&nbsp;&nbsp;.annotatedWith(ResourceServiceDescriptionLabelProvider.class)<br>
&nbsp;&nbsp;&nbsp;&nbsp;.to(MyCustomDefaultDescriptionLabelProvider.class);<br>
}<br>

</code>
</p>
</div>
</div>
</div>
</body>
</html>

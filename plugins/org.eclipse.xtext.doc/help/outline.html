<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Outline View</title>
<link href="book.css" rel="stylesheet" type="text/css">
<meta content="DocBook XSL Stylesheets V1.75.1" name="generator">
<link rel="home" href="index.html" title="Xtext User Guide">
<link rel="up" href="IDEconcepts.html" title="IDE concepts">
<link rel="prev" href="templates.html" title="Template Proposals">
<link rel="next" href="formatting.html" title="Formatting (Pretty Printing)">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<h1 xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0">Outline View</h1>
<p>Xtext provides an outline view to help you navigate your models. By default, it provides a hierarchical view on your model and allows you to sort tree elements alphabetically. Selecting an element in the outline will highlight the corresponding element in the text editor. Users can choose to synchronize the outline with the editor selection by clicking the 
				<span class="emphasis"><em>Link with Editor</em></span> button.
			</p>
<p>
				
</p>
<div class="mediaobject">
<img src="images/sample_outline.png"></div>
<p>
			
</p>
<p>You can customize various aspects of the outline by providing implementation for its various interfaces. The following sections show how to do this.</p>
<div class="section" title="Influencing the outline structure">
<div class="titlepage">
<div>
<div>
<h3 class="title">
<a name="Influencingtheoutlinestructure"></a>Influencing the outline structure</h3>
</div>
</div>
</div>
<p>In its default implementation, the outline view shows the containment hierarchy of your model. This should be sufficient in most cases. If you want to adjust the structure of the outline, i.e., by omitting a certain kind of node or by introducing additional even virtual nodes, you customize the outline by implementing 
					<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.ui.common/src/org/eclipse/xtext/ui/common/editor/outline/transformer/ISemanticModelTransformer.java?root=Modeling_Project&view=co" target="_new">ISemanticModelTransformer</a>.
				</p>
<p>The Xtext wizard creates an empty transformer class (
					<code class="code">MyDslTransformer</code>) for your convenience. To transform the semantic model delivered by the Xtext parser, you need to provide transformation methods for each of the meta classes that are of interest:
				</p>
<div class="literallayout">
<p>
<code class="code">public&nbsp;class&nbsp;MyDslTransformer&nbsp;extends&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;AbstractDeclarativeSemanticModelTransformer&nbsp;{&nbsp;<br>
&nbsp;&nbsp;/**<br>
&nbsp;&nbsp;&nbsp;*&nbsp;This&nbsp;method&nbsp;will&nbsp;be&nbsp;called&nbsp;by&nbsp;naming&nbsp;convention:<br>
&nbsp;&nbsp;&nbsp;*&nbsp;-&nbsp;method&nbsp;name&nbsp;must&nbsp;be&nbsp;createNode<br>
&nbsp;&nbsp;&nbsp;*&nbsp;-&nbsp;first&nbsp;param:&nbsp;subclass&nbsp;of&nbsp;EObject<br>
&nbsp;&nbsp;&nbsp;*&nbsp;-&nbsp;second&nbsp;param:&nbsp;ContentOutlineNode&nbsp;<br>
&nbsp;&nbsp;&nbsp;*/<br>
&nbsp;&nbsp;public&nbsp;ContentOutlineNode&nbsp;createNode(<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Attribute&nbsp;semanticNode,&nbsp;ContentOutlineNode&nbsp;parentNode)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;ContentOutlineNode&nbsp;node&nbsp;=&nbsp;super.newOutlineNode(semanticNode,&nbsp;parentNode);<br>
&nbsp;&nbsp;&nbsp;&nbsp;node.setLabel("special&nbsp;"&nbsp;+&nbsp;node.getLabel());<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;node;<br>
&nbsp;&nbsp;}<br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;public&nbsp;ContentOutlineNode&nbsp;createNode(<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Property&nbsp;semanticNode,&nbsp;ContentOutlineNode&nbsp;parentNode)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;ContentOutlineNode&nbsp;node&nbsp;=&nbsp;super.newOutlineNode(semanticNode,&nbsp;parentNode);<br>
&nbsp;&nbsp;&nbsp;&nbsp;node.setLabel("pimped&nbsp;"&nbsp;+&nbsp;node.getLabel());<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;node;<br>
&nbsp;&nbsp;}<br>

<br>
&nbsp;&nbsp;/**<br>
&nbsp;&nbsp;&nbsp;*&nbsp;This&nbsp;method&nbsp;will&nbsp;be&nbsp;called&nbsp;by&nbsp;naming&nbsp;convention:<br>
&nbsp;&nbsp;&nbsp;*&nbsp;-&nbsp;method&nbsp;name&nbsp;must&nbsp;be&nbsp;getChildren<br>
&nbsp;&nbsp;&nbsp;*&nbsp;-&nbsp;first&nbsp;param:&nbsp;subclass&nbsp;of&nbsp;EObject<br>
&nbsp;&nbsp;&nbsp;*/<br>
&nbsp;&nbsp;public&nbsp;List&lt;EObject&gt;&nbsp;getChildren(Attribute&nbsp;attribute)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;attribute.eContents();<br>
&nbsp;&nbsp;}<br>

<br>
&nbsp;&nbsp;public&nbsp;List&lt;EObject&gt;&nbsp;getChildren(Property&nbsp;property)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;NO_CHILDREN;<br>
&nbsp;&nbsp;}<br>
}<br>

<br>

</code>
</p>
</div>
<p>To make sure Xtext picks up your new outline transformer, you have to register your implementation with your UI module: </p>
<div class="literallayout">
<p>
<code class="code">public&nbsp;class&nbsp;MyDslUiModule&nbsp;extends&nbsp;AbstractXtextUiModule&nbsp;{<br>

<br>
&nbsp;&nbsp;@Override<br>
&nbsp;&nbsp;public&nbsp;Class&lt;?&nbsp;extends&nbsp;ISemanticModelTransformer&gt;&nbsp;<br>
&nbsp;&nbsp;		bindISemanticModelTransformer()&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;MyDslTransformer.class;<br>
&nbsp;&nbsp;}<br>
&nbsp;&nbsp;...<br>
}<br>

<br>

</code>
</p>
</div>
</div>
<div class="section" title="Filtering">
<div class="titlepage">
<div>
<div>
<h3 class="title">
<a name="Filtering"></a>Filtering</h3>
</div>
</div>
</div>
<p>Often, you want to allow users to filter the contents of the outline to make it easier to concentrate on the relevant aspects of the model. To add filtering capabilities to your outline, you need to add 
					<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.ui.common/src/org/eclipse/xtext/ui/common/editor/outline/actions/AbstractFilterAction.java?root=Modeling_Project&view=co" target="_new">AbstractFilterAction</a>s to the outline. Actions can be contributed by implementing and registering a 
					<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.ui.common/src/org/eclipse/xtext/ui/common/editor/outline/actions/DeclarativeActionBarContributor.java?root=Modeling_Project&view=co" target="_new">DeclarativeActionBarContributor</a>.
				</p>
<p>To register a 
					<code class="code">DeclarativeActionBarContributor</code>, add the following lines to your 
					<code class="code">MyDslUiModule</code> class:
				</p>
<div class="literallayout">
<p>
<code class="code">/**<br>
&nbsp;*&nbsp;Use&nbsp;this&nbsp;class&nbsp;to&nbsp;register&nbsp;components&nbsp;to&nbsp;be&nbsp;used&nbsp;within&nbsp;the&nbsp;IDE.<br>
&nbsp;*/<br>
public&nbsp;class&nbsp;MyDslUiModule&nbsp;extends&nbsp;org.xtext.example.AbstractMyDslUiModule&nbsp;{<br>

<br>
&nbsp;&nbsp;...<br>

<br>
&nbsp;&nbsp;@Override<br>
&nbsp;&nbsp;public&nbsp;Class&lt;?&nbsp;extends&nbsp;IActionBarContributor&gt;&nbsp;bindIActionBarContributor()&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;MyDslActionBarContributor.class;<br>
&nbsp;&nbsp;}<br>
}<br>

<br>

</code>
</p>
</div>
<p>The action bar contributor will look like this:</p>
<div class="literallayout">
<p>
<code class="code">public&nbsp;class&nbsp;MyDslActionBarContributor&nbsp;extends<br>
&nbsp;&nbsp;&nbsp;&nbsp;DeclarativeActionBarContributor&nbsp;{<br>
&nbsp;&nbsp;public&nbsp;Action&nbsp;addFilterParserRulesToolbarAction(<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XtextContentOutlinePage&nbsp;page)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;FilterFooAction(page);<br>
&nbsp;&nbsp;}<br>
}<br>

<br>

</code>
</p>
</div>
<p>Filter actions must extend 
					<code class="code">AbstractFilterAction</code> (this ensures that the action toggle state is handled correctly):
				</p>
<div class="literallayout">
<p>
<code class="code">public&nbsp;class&nbsp;FilterFooAction&nbsp;extends&nbsp;AbstractFilterAction&nbsp;{<br>

<br>
&nbsp;&nbsp;public&nbsp;FilterFooAction(XtextContentOutlinePage&nbsp;outlinePage)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;super("Filter&nbsp;Foo",&nbsp;outlinePage);<br>
&nbsp;&nbsp;&nbsp;&nbsp;setToolTipText("Show&nbsp;/&nbsp;hide&nbsp;foo");<br>
&nbsp;&nbsp;&nbsp;&nbsp;setDescription("Show&nbsp;/&nbsp;hide&nbsp;foo");<br>
&nbsp;&nbsp;&nbsp;&nbsp;setImageDescriptor(Activator.getImageDescriptor("icons/foo.gif"));<br>
&nbsp;&nbsp;&nbsp;&nbsp;setDisabledImageDescriptor(<br>
&nbsp;&nbsp;&nbsp;&nbsp;	Activator.getImageDescriptor("icons/foo.gif"));<br>
&nbsp;&nbsp;}<br>

<br>
&nbsp;&nbsp;@Override<br>
&nbsp;&nbsp;protected&nbsp;String&nbsp;getToggleId()&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;"FilterFooAction.isChecked";<br>
&nbsp;&nbsp;}<br>
	
<br>
&nbsp;&nbsp;@Override<br>
&nbsp;&nbsp;protected&nbsp;ViewerFilter&nbsp;createFilter()&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;FooOutlineFilter();<br>
&nbsp;&nbsp;}<br>

<br>
}<br>

<br>

</code>
</p>
</div>
<p>The filtering itself will be performed by 
					<code class="code">FooOutlineFilter</code>:
				</p>
<div class="literallayout">
<p>
<code class="code">public&nbsp;class&nbsp;FooOutlineFilter&nbsp;extends&nbsp;ViewerFilter&nbsp;{<br>

<br>
&nbsp;&nbsp;@Override<br>
&nbsp;&nbsp;public&nbsp;boolean&nbsp;select(<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Viewer&nbsp;viewer,&nbsp;Object&nbsp;parentElement,&nbsp;Object&nbsp;element)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;((parentElement&nbsp;!=&nbsp;null)&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;(parentElement&nbsp;instanceof&nbsp;ContentOutlineNode))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ContentOutlineNode&nbsp;parentNode&nbsp;=&nbsp;(ContentOutlineNode)&nbsp;parentElement;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EClass&nbsp;clazz&nbsp;=&nbsp;parentNode.getClazz();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(clazz.equals(MyDslPackage.Literals.ATTRIBUTE))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;<br>
&nbsp;&nbsp;}<br>

<br>
}<br>

<br>

</code>
</p>
</div>
</div>
<div class="section" title="Context menus">
<div class="titlepage">
<div>
<div>
<h3 class="title">
<a name="Contextmenus"></a>Context menus</h3>
</div>
</div>
</div>
<p>You might want to register context menu actions for specific elements in the outline, e.g. to allow users of your DSL to invoke a generator or to validate the selected element. As all elements in the outline are 
					<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.ui.common/src/org/eclipse/xtext/ui/common/editor/outline/ContentOutlineNode.java?root=Modeling_Project&view=co" target="_new">ContentOutlineNode</a>s, you cannot easily register an 
					<a class="ulink" href="http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.platform.doc.isv/guide/workbench_basicext_popupMenus.htm" target="_new">Object contribution</a>. (Besides, using the extension point 
					<code class="code">org.eclipse.ui.popupMenus</code> is regarded somewhat old school &ndash; you should rather use the new command and expression framework, as depicted below).
				</p>
<p>So to register context menus for specific node types of your meta model, you need to do the following:</p>
<div class="itemizedlist">
<ul class="itemizedlist" type="disc">
<li class="listitem">
<p>register a 
							<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.ui.common/src/org/eclipse/xtext/ui/common/editor/outline/actions/IContentOutlineNodeAdapterFactory.java?root=Modeling_Project&view=co" target="_new">IContentOutlineNodeAdapterFactory</a> which will translate 
							<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.ui.common/src/org/eclipse/xtext/ui/common/editor/outline/ContentOutlineNode.java?root=Modeling_Project&view=co" target="_new">ContentOutlineNode</a>s to their underlying node type
						</p>
</li>
<li class="listitem">
<p>register a menu contribution to add a command / handler pair to the context menu for the specific node types you&rsquo;re interested in.</p>
</li>
</ul>
</div>
<div class="section" title="Registering an IContentOutlineNodeAdapterFactory">
<div class="titlepage">
<div>
<div>
<h4 class="title">
<a name="RegisteringanIContentOutlineNodeAdapterFactory"></a>Registering an 
						<code class="code">IContentOutlineNodeAdapterFactory</code>
					
</h4>
</div>
</div>
</div>
<p>Create a subclass of 
						<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.ui.common/src/org/eclipse/xtext/ui/common/editor/outline/actions/DefaultContentOutlineNodeAdapterFactory.java?root=Modeling_Project&view=co" target="_new">DefaultContentOutlineNodeAdapterFactory</a> - this class contains some base infrastructure to manage adapters for your node types. In your subclass, you need to override 
						<code class="code">getAdapterList()</code> and return an array of classes. This is the list of classes you want to add context menus to:
					</p>
<div class="literallayout">
<p>
<code class="code">public&nbsp;class&nbsp;MyDslContentOutlineNodeAdapterFactory&nbsp;extends&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;DefaultContentOutlineNodeAdapterFactory&nbsp;{<br>
&nbsp;&nbsp;@SuppressWarnings("unchecked")<br>
&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;Class[]&nbsp;types&nbsp;=&nbsp;{&nbsp;Attribute.class&nbsp;};<br>

<br>
&nbsp;&nbsp;@SuppressWarnings("unchecked")<br>
&nbsp;&nbsp;public&nbsp;Class[]&nbsp;getAdapterList()&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;types;<br>
&nbsp;&nbsp;}<br>
}<br>

<br>

</code>
</p>
</div>
<p>Register this class with your 
						<code class="code">MyDslUiModule</code> to make it available to your DSL editor:
					</p>
<div class="literallayout">
<p>
<code class="code">public&nbsp;class&nbsp;MyDslUiModule&nbsp;extends&nbsp;AbstractMyDslUiModule&nbsp;{<br>
&nbsp;&nbsp;...<br>
&nbsp;&nbsp;public&nbsp;Class&lt;?&nbsp;extends&nbsp;IContentOutlineNodeAdapterFactory&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bindIContentOutlineNodeAdapterFactory()&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;org.example.myDSLContentOutlineNodeAdapterFactory.class;<br>
&nbsp;&nbsp;}<br>
&nbsp;&nbsp;...<br>
}<br>

<br>

</code>
</p>
</div>
</div>
<div class="section" title="Registering a menu contribution">
<div class="titlepage">
<div>
<div>
<h4 class="title">
<a name="Registeringamenucontribution"></a>Registering a menu contribution</h4>
</div>
</div>
</div>
<p>After you have registered the 
						<a class="ulink" href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.tmf/org.eclipse.xtext/plugins/org.eclipse.xtext.ui.common/src/org/eclipse/xtext/ui/common/editor/outline/actions/IContentOutlineNodeAdapterFactory.java?root=Modeling_Project&view=co" target="_new">IContentOutlineNodeAdapterFactory</a>, you can add command / handler pairs to the context menu.
					</p>
<p>First, you need to define a command &ndash; it will serve as a handle to glue together the handler and the menu contribution:</p>
<div class="literallayout">
<p>
<code class="code">
<br>
&lt;extension<br>
&nbsp;&nbsp;point="org.eclipse.ui.commands"&gt;<br>
&nbsp;&nbsp;&lt;command<br>
&nbsp;&nbsp;&nbsp;&nbsp;id="org.example.mydsl.ui.editor.outline.SampleOutlineCommand"<br>
&nbsp;&nbsp;&nbsp;&nbsp;name="Sample&nbsp;Command"<br>
&nbsp;&nbsp;&nbsp;&nbsp;description="Just&nbsp;a&nbsp;sample&nbsp;command"&gt;<br>
&nbsp;&nbsp;&lt;/command&gt;<br>
&lt;/extension&gt;<br>

<br>

</code>
</p>
</div>
<p>Next, you need to define a handler which will eventually execute the code to operate on the selected node. Please pay special attention to the attribute 
						<code class="code">commandId</code> - it must match the 
						<code class="code">id</code> attribute of your command. 
					</p>
<div class="literallayout">
<p>
<code class="code">
<br>
&lt;extension<br>
&nbsp;&nbsp;point="org.eclipse.ui.handlers"&gt;<br>
&nbsp;&nbsp;&lt;handler<br>
&nbsp;&nbsp;&nbsp;&nbsp;class="org.example.mydsl.ui.editor.outline.SampleOutlineNodeHandler"<br>
&nbsp;&nbsp;&nbsp;&nbsp;commandId="org.example.mydsl.ui.editor.outline.SampleOutlineCommand"&gt;<br>
&nbsp;&nbsp;&lt;/handler&gt;<br>
&lt;/extension&gt;<br>

<br>

</code>
</p>
</div>
<p>Finally, define a 
						<code class="code">menuContribution</code> to add the command to the context menu:
					</p>
<div class="literallayout">
<p>
<code class="code">
<br>
&lt;extension<br>
&nbsp;&nbsp;point="org.eclipse.ui.menus"&gt;<br>
&nbsp;&nbsp;&lt;menuContribution<br>
&nbsp;&nbsp;&nbsp;&nbsp;locationURI="popup:org.eclipse.xtext.ui.common.outline?after=additions"&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;command<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;commandId="org.example.mydsl.ui.editor.outline.SampleOutlineCommand"<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label="Sample&nbsp;action&nbsp;registered&nbsp;for&nbsp;Attributes"&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;visibleWhen&nbsp;checkEnabled="false"&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;iterate&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;adapt&nbsp;type="org.example.mydsl.Attribute"&nbsp;/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/iterate&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/visibleWhen&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/command&gt;<br>
&nbsp;&nbsp;&lt;/menuContribution&gt;<br>
&lt;/extension&gt;<br>

<br>

</code>
</p>
</div>
<p>Again, pay attention to the 
						<code class="code">commandId</code> attribute. The connection between your node type(s) and the menu contribution is made by the part 
						<code class="code">&lt;adapt type="org.example.mydsl.Attribute" /&gt;</code>. 
					</p>
</div>
</div>
</body>
</html>

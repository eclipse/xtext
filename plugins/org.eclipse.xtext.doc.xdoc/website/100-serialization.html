<br style="clear:both;height:1em;">
	<div id="leftcol">
		<div class="nav-logo">
			<a href="index.php"><img src="logo.png" style="margin-left:10px; width:155px"/></a>
		</div>
		<ul id="leftnav">
		<li class="partentry" >
		Getting Started
		</li>
		<li class="separator"><div class="separator">
		<img src="triangle.gif" style="height:12px; margin-right: 2px; "  /><img src="triangle-90.gif" style="display:none; margin-right: 2px" height="12px" />
		<a href="005-installation.php">Installation</a></div>
		<ul style="display: none;" id="subToc_005-installation.html">
		<li id="005-installation.html#InstallDistro.html" ><a href="005-installation.php#InstallDistro.php" >Install Pre-Configured Eclipse With Xtext</a></li>
		<li id="005-installation.html#InstallXtext.html" ><a href="005-installation.php#InstallXtext.php" >Install Xtext From Update Site</a></li>
		</ul>
		</li>
		<li class="separator"><div class="separator">
		<img src="triangle.gif" style="height:12px; margin-right: 2px; "  /><img src="triangle-90.gif" style="display:none; margin-right: 2px" height="12px" />
		<a href="010-xtext-in-5-minutes.php">5 Minutes Tutorial</a></div>
		<ul style="display: none;" id="subToc_010-xtext-in-5-minutes.html">
		<li id="010-xtext-in-5-minutes.html#NewProject.html" ><a href="010-xtext-in-5-minutes.php#NewProject.php" >Creating A New Xtext Project</a></li>
		<li id="010-xtext-in-5-minutes.html#RunWorkflow.html" ><a href="010-xtext-in-5-minutes.php#RunWorkflow.php" >Generating The Language Infrastructure</a></li>
		<li id="010-xtext-in-5-minutes.html#TestingTheEditor.html" ><a href="010-xtext-in-5-minutes.php#TestingTheEditor.php" >Try The Editor</a></li>
		<li id="010-xtext-in-5-minutes.html#Conclusion.html" ><a href="010-xtext-in-5-minutes.php#Conclusion.php" >Conclusion</a></li>
		</ul>
		</li>
		<li class="separator"><div class="separator">
		<img src="triangle.gif" style="height:12px; margin-right: 2px; "  /><img src="triangle-90.gif" style="display:none; margin-right: 2px" height="12px" />
		<a href="020-domainmodel-step-by-step.php">15 Minutes Tutorial</a></div>
		<ul style="display: none;" id="subToc_020-domainmodel-step-by-step.html">
		<li id="020-domainmodel-step-by-step.html#DomainModelWalkThrough_4.html" ><a href="020-domainmodel-step-by-step.php#DomainModelWalkThrough_4.php" >Create A New Xtext Project</a></li>
		<li id="020-domainmodel-step-by-step.html#DomainModelWalkThrough_5.html" ><a href="020-domainmodel-step-by-step.php#DomainModelWalkThrough_5.php" >Write Your Own Grammar</a></li>
		<li id="020-domainmodel-step-by-step.html#DomainModelWalkThrough_6.html" ><a href="020-domainmodel-step-by-step.php#DomainModelWalkThrough_6.php" >Generate Language Artifacts</a></li>
		<li id="020-domainmodel-step-by-step.html#DomainModelWalkThrough_7.html" ><a href="020-domainmodel-step-by-step.php#DomainModelWalkThrough_7.php" >Run the Generated IDE Plug-in</a></li>
		<li id="020-domainmodel-step-by-step.html#DomainModelWalkThrough_8.html" ><a href="020-domainmodel-step-by-step.php#DomainModelWalkThrough_8.php" >Second Iteration : Adding Packages and Imports</a></li>
		</ul>
		</li>
		<li class="separator"><div class="separator">
		<img src="triangle.gif" style="height:12px; margin-right: 2px; "  /><img src="triangle-90.gif" style="display:none; margin-right: 2px" height="12px" />
		<a href="030-tutorial-next-steps.php">15 Minutes Tutorial - Extended</a></div>
		<ul style="display: none;" id="subToc_030-tutorial-next-steps.html">
		<li id="040-first-code-generator.html" ><a href="040-first-code-generator.php" >Writing a Code Generator With Xtend</a></li>
		<li id="060-unit-tests.html" ><a href="060-unit-tests.php" >Unit Testing the Language</a></li>
		<li id="050-validation.html" ><a href="050-validation.php" >Creating Custom Validation Rules</a></li>
		</ul>
		</li>
		<li class="separator"><div class="separator">
		<img src="triangle.gif" style="height:12px; margin-right: 2px; "  /><img src="triangle-90.gif" style="display:none; margin-right: 2px" height="12px" />
		<a href="035-domainmodel-java.php">Five simple steps to your JVM language</a></div>
		<ul style="display: none;" id="subToc_035-domainmodel-java.html">
		<li id="035-domainmodel-java.html#JvmDomainmodel_7.html" ><a href="035-domainmodel-java.php#JvmDomainmodel_7.php" >Step One: Create A New Xtext Project</a></li>
		<li id="035-domainmodel-java.html#JvmDomainmodel_8.html" ><a href="035-domainmodel-java.php#JvmDomainmodel_8.php" >Step Two: Write the Grammar</a></li>
		<li id="035-domainmodel-java.html#JvmDomainmodel_9.html" ><a href="035-domainmodel-java.php#JvmDomainmodel_9.php" >Step Three: Generate Language Artifacts</a></li>
		<li id="035-domainmodel-java.html#JvmDomainmodel_10.html" ><a href="035-domainmodel-java.php#JvmDomainmodel_10.php" >Step Four: Define the Mapping to JVM Concepts</a></li>
		<li id="035-domainmodel-java.html#JvmDomainmodel_11.html" ><a href="035-domainmodel-java.php#JvmDomainmodel_11.php" >Step Five : Try the Editor!</a></li>
		</ul>
		</li>
		<li class="partentry" >
		Reference Documentation
		</li>
		<li class="separator"><div class="separator">
		<img src="triangle.gif" style="height:12px; margin-right: 2px; "  /><img src="triangle-90.gif" style="display:none; margin-right: 2px" height="12px" />
		<a href="000-introduction.php">Overview</a></div>
		<ul style="display: none;" id="subToc_000-introduction.html">
		<li id="000-introduction.html#Overview_1.html" ><a href="000-introduction.php#Overview_1.php" >What is Xtext?</a></li>
		<li id="000-introduction.html#Overview_2.html" ><a href="000-introduction.php#Overview_2.php" >How Does It Work?</a></li>
		<li id="000-introduction.html#Overview_3.html" ><a href="000-introduction.php#Overview_3.php" >Xtext is Highly Configurable</a></li>
		<li id="000-introduction.html#Overview_4.html" ><a href="000-introduction.php#Overview_4.php" >Who Uses Xtext?</a></li>
		<li id="000-introduction.html#Overview_5.html" ><a href="000-introduction.php#Overview_5.php" >Who is Behind Xtext?</a></li>
		<li id="000-introduction.html#DSL.html" ><a href="000-introduction.php#DSL.php" >What is a Domain-Specific Language</a></li>
		</ul>
		</li>
		<li class="separator"><div class="separator">
		<img src="triangle.gif" style="height:12px; margin-right: 2px; "  /><img src="triangle-90.gif" style="display:none; margin-right: 2px" height="12px" />
		<a href="020-grammar-language.php">The Grammar Language</a></div>
		<ul style="display: none;" id="subToc_020-grammar-language.html">
		<li id="020-grammar-language.html#statemachine.html" ><a href="020-grammar-language.php#statemachine.php" >A First Example</a></li>
		<li id="020-grammar-language.html#syntax.html" ><a href="020-grammar-language.php#syntax.php" >The Syntax</a></li>
		<li id="020-grammar-language.html#metamodelInference.html" ><a href="020-grammar-language.php#metamodelInference.php" >Ecore Model Inference</a></li>
		<li id="020-grammar-language.html#grammarMixins.html" ><a href="020-grammar-language.php#grammarMixins.php" >Grammar Mixins</a></li>
		<li id="020-grammar-language.html#grammarLanguage_6.html" ><a href="020-grammar-language.php#grammarLanguage_6.php" >Common Terminals</a></li>
		</ul>
		</li>
		<li class="separator"><div class="separator">
		<img src="triangle.gif" style="height:12px; margin-right: 2px; "  /><img src="triangle-90.gif" style="display:none; margin-right: 2px" height="12px" />
		<a href="030-generator.php">Configuration</a></div>
		<ul style="display: none;" id="subToc_030-generator.html">
		<li id="030-generator.html#generator.html" ><a href="030-generator.php#generator.php" >The Language Generator</a></li>
		<li id="040-dependency-injection.html" ><a href="040-dependency-injection.php" >Dependency Injection in Xtext with Google Guice</a></li>
		</ul>
		</li>
		<li class="separator"><div class="separator">
		<img src="triangle.gif" style="height:12px; margin-right: 2px; "  /><img src="triangle-90.gif" style="display:none; margin-right: 2px" height="12px" />
		<a href="050-heading-runtime.php">Runtime Concepts</a></div>
		<ul style="display: none;" id="subToc_050-heading-runtime.html">
		<li id="050-heading-runtime.html#runtimeSetup.html" ><a href="050-heading-runtime.php#runtimeSetup.php" >Runtime Setup (ISetup)</a></li>
		<li id="050-heading-runtime.html#equinoxSetup.html" ><a href="050-heading-runtime.php#equinoxSetup.php" >Setup within Eclipse-Equinox (OSGi)</a></li>
		<li id="050-heading-runtime.html#runtime_concepts_4.html" ><a href="050-heading-runtime.php#runtime_concepts_4.php" >Logging</a></li>
		<li id="060-validation.html" ><a href="060-validation.php" >Validation</a></li>
		<li id="070-linking.html" ><a href="070-linking.php" >Linking</a></li>
		<li id="080-scoping.html" ><a href="080-scoping.php" >Scoping</a></li>
		<li id="090-valueconverter.html" ><a href="090-valueconverter.php" >Value Converter</a></li>
		<li id="100-serialization.html" ><a href="100-serialization.php" >Serialization</a></li>
		<li id="105-formatting.html" ><a href="105-formatting.php" >Formatting (Pretty Printing)</a></li>
		<li id="110-fragmentprovider.html" ><a href="110-fragmentprovider.php" >Fragment Provider (Referencing Xtext Models From Other EMF Artifacts)</a></li>
		<li id="115-encoding.html" ><a href="115-encoding.php" >Encoding in Xtext</a></li>
		</ul>
		</li>
		<li class="separator"><div class="separator">
		<img src="triangle.gif" style="height:12px; margin-right: 2px; "  /><img src="triangle-90.gif" style="display:none; margin-right: 2px" height="12px" />
		<a href="120-heading-UI.php">IDE Concepts</a></div>
		<ul style="display: none;" id="subToc_120-heading-UI.html">
		<li id="140-labelprovider.html" ><a href="140-labelprovider.php" >Label Provider</a></li>
		<li id="150-contentassist.html" ><a href="150-contentassist.php" >Content Assist</a></li>
		<li id="155-quickfix.html" ><a href="155-quickfix.php" >Quick Fixes</a></li>
		<li id="160-templates.html" ><a href="160-templates.php" >Template Proposals</a></li>
		<li id="170-outline.html" ><a href="170-outline.php" >Outline View</a></li>
		<li id="180-hyperlinking.html" ><a href="180-hyperlinking.php" >Hyperlinking</a></li>
		<li id="195-highlighting.html" ><a href="195-highlighting.php" >Syntax Coloring</a></li>
		<li id="197-refactoring.html" ><a href="197-refactoring.php" >Rename Refactoring</a></li>
		</ul>
		</li>
		<li class="separator"><div class="separator">
		<img src="triangle.gif" style="height:12px; margin-right: 2px; "  /><img src="triangle-90.gif" style="display:none; margin-right: 2px" height="12px" />
		<a href="199-xtext-and-java.php">Xtext and Java</a></div>
		<ul style="display: none;" id="subToc_199-xtext-and-java.html">
		<li id="199-xtext-and-java.html#Xbase_3.html" ><a href="199-xtext-and-java.php#Xbase_3.php" >Plug-in Setup</a></li>
		<li id="199a-jvmtypes.html" ><a href="199a-jvmtypes.php" >Referring to Java Elements using JVM Types</a></li>
		<li id="199b-xbase-java-references.html" ><a href="199b-xbase-java-references.php" >Referring to Java Types Using Xbase</a></li>
		<li id="199c-xbase-inferred-type.html" ><a href="199c-xbase-inferred-type.php" >Inferring a JVM Model</a></li>
		<li id="199d-xbase-expressions.html" ><a href="199d-xbase-expressions.php" >Using Xbase Expressions</a></li>
		<li id="199e-xbase-language-reference.html" ><a href="199e-xbase-language-reference.php" >Xbase Language Reference</a></li>
		</ul>
		</li>
		<li class="separator"><div class="separator">
		<img src="triangle.gif" style="height:12px; margin-right: 2px; "  /><img src="triangle-90.gif" style="display:none; margin-right: 2px" height="12px" />
		<a href="118-mwe-in-depth.php">MWE2</a></div>
		<ul style="display: none;" id="subToc_118-mwe-in-depth.html">
		<li id="118-mwe-in-depth.html#MWE2Exampe.html" ><a href="118-mwe-in-depth.php#MWE2Exampe.php" >Examples</a></li>
		<li id="118-mwe-in-depth.html#MWE2LanguageReference.html" ><a href="118-mwe-in-depth.php#MWE2LanguageReference.php" >Language Reference</a></li>
		<li id="118-mwe-in-depth.html#MWE2SyntaxReference.html" ><a href="118-mwe-in-depth.php#MWE2SyntaxReference.php" >Syntax Reference</a></li>
		</ul>
		</li>
		<li class="separator"><div class="separator">
		<img src="triangle.gif" style="height:12px; margin-right: 2px; "  /><img src="triangle-90.gif" style="display:none; margin-right: 2px" height="12px" />
		<a href="210-emf-integration.php">Integration with EMF and Other EMF Editors</a></div>
		<ul style="display: none;" id="subToc_210-emf-integration.html">
		<li id="210-emf-integration.html#model_metamodel.html" ><a href="210-emf-integration.php#model_metamodel.php" >Model, Ecore Model, and Ecore</a></li>
		<li id="210-emf-integration.html#emf_codegen.html" ><a href="210-emf-integration.php#emf_codegen.php" >EMF Code Generation</a></li>
		<li id="210-emf-integration.html#xtext_resource.html" ><a href="210-emf-integration.php#xtext_resource.php" >XtextResource Implementation</a></li>
		<li id="210-emf-integration.html#gmf_integration.html" ><a href="210-emf-integration.php#gmf_integration.php" >Integration with GMF Editors</a></li>
		</ul>
		</li>
		<li class="partentry" >
		Appendix
		</li>
		<li class="separator"><div class="separator">
		<img src="triangle.gif" style="height:12px; margin-right: 2px; "  /><img src="triangle-90.gif" style="display:none; margin-right: 2px" height="12px" />
		<a href="213-migrating-from-1.0.php">Migrating from Xtext 1.0.x to 2.0</a></div>
		<ul style="display: none;" id="subToc_213-migrating-from-1.0.html">
		<li id="213-migrating-from-1.0.html#migrating_from_1_0_x_4.html" ><a href="213-migrating-from-1.0.php#migrating_from_1_0_x_4.php" >Take the Shortcut</a></li>
		<li id="213-migrating-from-1.0.html#migrating_from_1_0_x_5.html" ><a href="213-migrating-from-1.0.php#migrating_from_1_0_x_5.php" >Migrating Step By Step</a></li>
		<li id="213-migrating-from-1.0.html#migrating_from_1_0_x_6.html" ><a href="213-migrating-from-1.0.php#migrating_from_1_0_x_6.php" >Now go for then new features</a></li>
		</ul>
		</li>
		<li class="separator"><div class="separator">
		<img src="triangle.gif" style="height:12px; margin-right: 2px; "  /><img src="triangle-90.gif" style="display:none; margin-right: 2px" height="12px" />
		<a href="215-migrating-from-0.7.php">Migrating from Xtext 0.7.x to 1.0</a></div>
		<ul style="display: none;" id="subToc_215-migrating-from-0.7.html">
		<li id="215-migrating-from-0.7.html#migrating_from_0_7_2.html" ><a href="215-migrating-from-0.7.php#migrating_from_0_7_2.php" >Migrating Step By Step</a></li>
		</ul>
		</li>
		</ul>
	</div>
	<div id="midcolumn">
		<a name="serialization" ></a>
		<span style="float:left; border-top: 1px dotted #d4d4dd; margin-left: 0; margin-top: 5px;
			padding: 5px 0;
			padding-top: 5px;"></span><a style="float: right" href="#">Top</a>
			<br style="clear:both"></br>
			<h1>Serialization</h1>
			<div class="toc">
			  <ul>
			    <li><a href="100-serialization.php#serializationcontract.php" >The Contract</a></li>
			    <li><a href="100-serialization.php#serialization_6.php" >Roles of the Semantic Model and the Node Model During Serialization</a></li>
			    <li><a href="100-serialization.php#parsetreeconstructor.php" >Parse Tree Constructor</a></li>
			    <li><a href="100-serialization.php#saveoptions.php" >Options</a></li>
			    <li><a href="100-serialization.php#commentassociater.php" >Preserving Comments from the Node Model</a></li>
			    <li><a href="100-serialization.php#transientvalues.php" >Transient Values</a></li>
			    <li><a href="100-serialization.php#unassignedtext.php" >Unassigned Text</a></li>
			    <li><a href="100-serialization.php#crossreferenceserializer.php" >Cross-Reference Serializer</a></li>
			    <li><a href="100-serialization.php#hiddentokenmerger.php" >Merge White Space</a></li>
			    <li><a href="100-serialization.php#tokenstream.php" >Token Stream</a></li>
			  </ul>
			</div>
			<p>
			Serialization is the process of transforming an EMF model into its textual representation. Thereby, 
			serialization complements parsing and lexing.
			</p>
			<p>
			In Xtext, the process of serialization is split into the following steps:
			</p>
			<p>
			<ol>
			  <li>Validating the semantic model. This is optional, enabled by default, done by the 
			  		 <a href="060-validation.php#concrete_syntax_validation.php" title="Go to &quot;Serializer: Concrete Syntax Validation&quot;">concrete syntax validator</a> and can be turned off in 
			  		 the <a href="100-serialization.php#saveoptions.php" title="Go to &quot;Options&quot;">save options</a>.</li>
			  <li>Matching the model elements with the grammar rules and creating a stream of tokens. 
			  		 This is done by the <a href="100-serialization.php#parsetreeconstructor.php" title="Go to &quot;Parse Tree Constructor&quot;">parse tree constructor</a>.</li>
			  <li>Associating comments with semantic objects. This is done by the
			  		 <a href="100-serialization.php#commentassociater.php" title="Go to &quot;Preserving Comments from the Node Model&quot;">comment associator</a>.</li>
			  <li>Associating existing nodes from the node model with tokens from the token stream.</li>
			  <li><a href="100-serialization.php#hiddentokenmerger.php" title="Go to &quot;Merge White Space&quot;">Merging existing white space</a> and line-wraps into the token stream.</li>
			  <li>Adding further needed white space or replacing all white space using a 
			  		<a href="105-formatting.php" title="Go to &quot;Formatting (Pretty Printing)&quot;">formatter</a>.</li>
			</ol>
			</p>
			<p>
			Serialization is invoked when calling 
			<a class="jdoc" href="http://download.eclipse.org/modeling/tmf/xtext/javadoc/2.3/org/eclipse/xtext/resource/XtextResource.html" title="org.eclipse.xtext.resource.XtextResource">XtextResource.save(..)</abbr></a> <a class="srcLink" href="https://github.com/eclipse/xtext/blob/v2.2.0/plugins/org.eclipse.xtext/src/org/eclipse/xtext/resource/XtextResource.java" title="View Source Code" >(src)</a>. Furthermore, the
			<a class="jdoc" href="http://download.eclipse.org/modeling/tmf/xtext/javadoc/2.3/org/eclipse/xtext/parsetree/reconstr/Serializer.html" title="org.eclipse.xtext.parsetree.reconstr.Serializer">Serializer</abbr></a> <a class="srcLink" href="https://github.com/eclipse/xtext/blob/v2.2.0/plugins/org.eclipse.xtext/src/org/eclipse/xtext/parsetree/reconstr/Serializer.java" title="View Source Code" >(src)</a> provides resource-independent 
			support for serialization. Another situation that triggers serialization is applying <a href="155-quickfix.php" title="Go to &quot;Quick Fixes&quot;">Quick Fixes</a> 
			with semantic modifications. Serialization is <em>not</em> called when a textual editors contents is saved to disk.
			</p>
			<a name="serializationcontract" ></a>
			<h2>The Contract</h2>
			<p>
			The contract of serialization says that a model which is saved (serialized) to its textual representation 
			and then loaded (parsed) again yields a new model that is equal to the original model. Please be 
			aware that this does <em>not</em> imply, that loading a textual representation and serializing it back produces 
			identical textual representations. However, the serialization algorithm tries to restore as much information
			as possible. That is, if the parsed model was not modified in-memory, the serialized output will usually
			be equal to the previous input. Unfortunately, this cannot be ensured for each and every case. A use
			case where is is hardly possible, is shown in the following example:
			</p>
			<p>
			<div class="literallayout">
				<div class="incode">
					<p class="code">
						MyRule:<br/>
						&nbsp;&nbsp;(xval+=ID&nbsp;|&nbsp;yval+=INT)*;
					</p>
				</div>
			</div>
			</p>
			<p>
			The given <em>MyRule</em> reads <em>ID</em>- and <em>INT</em>-elements which may occur in an arbitrary order in 
			the textual representation. However, when serializing the model all <em>ID</em>-elements will be written 
			first and then all <em>INT</em>-elements. If the order is important it can be preserved by storing all elements 
			in the same list - which may require wrapping the <em>ID</em>- and <em>INT</em>-elements into other objects.
			</p>
			<a name="serialization_6" ></a>
			<h2>Roles of the Semantic Model and the Node Model During Serialization</h2>
			<p>
			A serialized document represents the state of the semantic model. However, if there is a node model 
			available (i.e. the semantic model has been created by the parser), the serializer
			<ul>
			  <li>preserves <a href="100-serialization.php#hiddentokenmerger.php" title="Go to &quot;Merge White Space&quot;">existing white spaces</a> from the node model.</li>
			  <li>preserves <a href="100-serialization.php#commentassociater.php" title="Go to &quot;Preserving Comments from the Node Model&quot;">existing comments</a> from the node model.</li>
			  <li>preserves the representation of cross-references: If a cross-referenced object can be 
			  		 identified by multiple names (i.e. scoping returns multiple 
			  		 <a class="jdoc" href="http://download.eclipse.org/modeling/tmf/xtext/javadoc/2.3/org/eclipse/xtext/resource/IEObjectDescription.html" title="org.eclipse.xtext.resource.IEObjectDescription">IEObjectDescriptions</abbr></a> <a class="srcLink" href="https://github.com/eclipse/xtext/blob/v2.2.0/plugins/org.eclipse.xtext/src/org/eclipse/xtext/resource/IEObjectDescription.java" title="View Source Code" >(src)</a> for the 
			  		 same object), the serializer tries to keep the name that was used in the input file.</li>
			  <li>preserves the representation of values: For values handled by the 
			  		<a href="090-valueconverter.php" title="Go to &quot;Value Converter&quot;">value converter</a>, the serializer checks whether the textual representation 
			  		converted to a value equals the value from the semantic model. If that is true, the textual 
			  		representation is kept.</li>
			</ul>
			</p>
			<a name="parsetreeconstructor" ></a>
			<h2>Parse Tree Constructor</h2>
			<p>
			The parse tree constructor usually does not need to be customized since it is automatically derived 
			from the <a href="020-grammar-language.php" title="Go to &quot;The Grammar Language&quot;">Xtext Grammar</a>. However, it can be helpful to look into it to understand 
			its error messages and its runtime performance.
			</p>
			<p>
			For serialization to succeed, the parse tree constructor must be able to <em>consume</em> every non-transient 
			element of the to-be-serialized EMF model. To <em>consume</em> means, in this context, to write the element to 
			the textual representation of the model. This can turn out to be a not-so-easy-to-fulfill requirement, 
			since a grammar usually introduces implicit constraints to the EMF model as explained for the 
			<a href="060-validation.php#concrete_syntax_validation.php" title="Go to &quot;Serializer: Concrete Syntax Validation&quot;">concrete syntax validator</a>.
			</p>
			<p>
			If a model can not be serialized, an 
			<a class="jdoc" href="http://download.eclipse.org/modeling/tmf/xtext/javadoc/2.3/org/eclipse/xtext/parsetree/reconstr/XtextSerializationException.html" title="org.eclipse.xtext.parsetree.reconstr.XtextSerializationException">XtextSerializationException</abbr></a> <a class="srcLink" href="https://github.com/eclipse/xtext/blob/v2.2.0/plugins/org.eclipse.xtext/src/org/eclipse/xtext/parsetree/reconstr/XtextSerializationException.java" title="View Source Code" >(src)</a> is thrown. 
			Possible reasons are listed below:
			</p>
			<p>
			<ul>
			  <li>A model element can not be consumed. This can have the following reasons/solutions:
			  		<ul>
			    <li>The model element should not be stored in the model.</li>
			    <li>The grammar needs an assignment which would consume the model element.</li>
			    <li>The <a href="100-serialization.php#transientvalues.php" title="Go to &quot;Transient Values&quot;">transient value service</a> can be used to indicate that this model 
			    			element should not be consumed.</li>
			  </ul>
			  
			  </li>
			  <li>An assignment in the grammar has no corresponding model element. The default transient 
			  		value service considers a model element to be transient if it is <em>unset</em> or <em>equals</em> its 
			  		default value. However, the parse tree constructor may serialize default values if 
			  		this is required by a grammar constraint to be able to serialize another model element.
			  		The following solution may help to solve such a scenario:
			  		<ul>
			    <li>A model element should be added to the model.</li>
			    <li>The assignment in the grammar should be made optional.</li>
			  </ul>
			  
			  </li>
			  <li>The type of the model element differs from the type in the grammar. The type of the model 
			  		element must be identical to the return type of the grammar rule or the action's type. 
			  		Subtypes are not allowed.</li>
			  <li><a href="090-valueconverter.php" title="Go to &quot;Value Converter&quot;">Value conversion</a> fails. The value converter can indicate that a value 
			  		is not serializeable by throwing a <a class="jdoc" href="http://download.eclipse.org/modeling/tmf/xtext/javadoc/2.3/org/eclipse/xtext/conversion/ValueConverterException.html" title="org.eclipse.xtext.conversion.ValueConverterException">ValueConverterException</abbr></a> <a class="srcLink" href="https://github.com/eclipse/xtext/blob/v2.2.0/plugins/org.eclipse.xtext/src/org/eclipse/xtext/conversion/ValueConverterException.java" title="View Source Code" >(src)</a>.</li>
			  <li>An enum literal is not allowed at this position. This can happen if the referenced enum 
			  		rule only lists a subset of the literals of the actual enumeration.</li>
			</ul>
			</p>
			<p>
			To understand error messages and performance issues of the parse tree constructor it is important to 
			know that it implements a backtracking algorithm. This basically means that the grammar is used to 
			specify the structure of a tree in which one path (from the root node to a leaf node) is a valid 
			serialization of a specific model. The parse tree constructor's task is to find this path - with the 
			condition, that all model elements are consumed while walking this path. The parse tree constructor's 
			strategy is to take the most promising branch first (the one that would consume the most model elements). 
			If the branch leads to a dead end (for example, if a model element needs to be consumed that is not 
			present in the model), the parse tree constructor goes back the path until a different branch can be 
			taken. This behavior has two consequences:
			<ul>
			  <li>In case of an error, the parse tree constructor has found only dead ends but no leaf. It cannot
			  		tell which dead end is actually erroneous. Therefore, the error message lists dead ends of the 
			  		longest paths, a fragment of their serialization and the reason why the path could not be continued 
			  		at this point. The developer has to judge on his own which reason is the actual error.</li>
			  <li>For reasons of performance, it is critical that the parse tree constructor takes the most promising
			  		branch first and detects wrong branches early. One way to achieve this is to avoid having many rules 
			  		which return the same type and which are called from within the same alternative in the grammar.</li>
			</ul>
			</p>
			<a name="saveoptions" ></a>
			<h2>Options</h2>
			<p>
			<a class="jdoc" href="http://download.eclipse.org/modeling/tmf/xtext/javadoc/2.3/org/eclipse/xtext/resource/SaveOptions.html" title="org.eclipse.xtext.resource.SaveOptions">SaveOptions</abbr></a> <a class="srcLink" href="https://github.com/eclipse/xtext/blob/v2.2.0/plugins/org.eclipse.xtext/src/org/eclipse/xtext/resource/SaveOptions.java" title="View Source Code" >(src)</a> can be passed to 
			<a class="jdoc" href="http://download.eclipse.org/modeling/tmf/xtext/javadoc/2.3/org/eclipse/xtext/resource/XtextResource.html" title="org.eclipse.xtext.resource.XtextResource">XtextResource.save(options)</abbr></a> <a class="srcLink" href="https://github.com/eclipse/xtext/blob/v2.2.0/plugins/org.eclipse.xtext/src/org/eclipse/xtext/resource/XtextResource.java" title="View Source Code" >(src)</a> and to 
			<a class="jdoc" href="http://download.eclipse.org/modeling/tmf/xtext/javadoc/2.3/org/eclipse/xtext/parsetree/reconstr/Serializer.html" title="org.eclipse.xtext.parsetree.reconstr.Serializer">Serializer.serialize(..)</abbr></a> <a class="srcLink" href="https://github.com/eclipse/xtext/blob/v2.2.0/plugins/org.eclipse.xtext/src/org/eclipse/xtext/parsetree/reconstr/Serializer.java" title="View Source Code" >(src)</a>. 
			Available options are:
			<ul>
			  <li><em>Formatting</em>. Default: <span class="inlinecode"><span class="keyword">false</span></span>. If enabled, it is the <a href="105-formatting.php" title="Go to &quot;Formatting (Pretty Printing)&quot;">formatters</a> job to determine
			   		all white space information during serialization. If disabled, the formatter only defines white
			   		space 
			   		information for the places in which no white space information can be preserved from the node model. 
			   		E.g. When new model elements are inserted or there is no node model.</li>
			  <li><em>Validating</em>. Default: <span class="inlinecode"><span class="keyword">true</span></span>: Run the <a href="060-validation.php#concrete_syntax_validation.php" title="Go to &quot;Serializer: Concrete Syntax Validation&quot;">concrete syntax validator</a> 
			  		before serializing the model.</li>
			</ul>
			</p>
			<a name="commentassociater" ></a>
			<h2>Preserving Comments from the Node Model</h2>
			<p>
			The <a class="jdoc" href="http://download.eclipse.org/modeling/tmf/xtext/javadoc/2.3/org/eclipse/xtext/parsetree/reconstr/ICommentAssociater.html" title="org.eclipse.xtext.parsetree.reconstr.ICommentAssociater">ICommentAssociater</abbr></a> <a class="srcLink" href="https://github.com/eclipse/xtext/blob/v2.2.0/plugins/org.eclipse.xtext/src/org/eclipse/xtext/parsetree/reconstr/ICommentAssociater.java" title="View Source Code" >(src)</a> associates 
			comments with semantic objects. This is important in case an element in the semantic model is moved 
			to a different position and the model is serialized, one expects the comments to be moved to the 
			new position in the document as well.
			</p>
			<p>
			Which comment belongs to which semantic object is surely a very subjective issue. The 
			<a class="jdoc" href="http://download.eclipse.org/modeling/tmf/xtext/javadoc/2.3/org/eclipse/xtext/parsetree/reconstr/impl/DefaultCommentAssociater.html" title="org.eclipse.xtext.parsetree.reconstr.impl.DefaultCommentAssociater">default 
			implementation</abbr></a> <a class="srcLink" href="https://github.com/eclipse/xtext/blob/v2.2.0/plugins/org.eclipse.xtext/src/org/eclipse/xtext/parsetree/reconstr/impl/DefaultCommentAssociater.java" title="View Source Code" >(src)</a>
			behaves as follows, but can be customized:
			<ul>
			  <li>If there is a semantic token before a comment and in the same line, the comment is associated 
			  		with this token's semantic object.</li>
			  <li>In all other cases, the comment is associated with the semantic object of the next following 
			  		object.</li>
			</ul>
			</p>
			<a name="transientvalues" ></a>
			<h2>Transient Values</h2>
			<p>
			Transient values are values or model elements which are not persisted (written to the textual 
			representation in the serialization phase). If a model contains model elements which can not be serialized 
			with the current grammar, it is critical to mark them transient using the 
			<a class="jdoc" href="http://download.eclipse.org/modeling/tmf/xtext/javadoc/2.3/org/eclipse/xtext/parsetree/reconstr/ITransientValueService.html" title="org.eclipse.xtext.parsetree.reconstr.ITransientValueService">ITransientValueService</abbr></a> <a class="srcLink" href="https://github.com/eclipse/xtext/blob/v2.2.0/plugins/org.eclipse.xtext/src/org/eclipse/xtext/parsetree/reconstr/ITransientValueService.java" title="View Source Code" >(src)</a>, or serialization 
			will fail. The default implementation marks all model elements transient, which are <span class="inlinecode">eStructuralFeature.isTransient()</span> 
			or not <span class="inlinecode">eObject.eIsSet(eStructuralFeature)</span>. By default, EMF returns <span class="inlinecode"><span class="keyword">false</span></span> for <span class="inlinecode">eIsSet(..)</span> if the 
			value equals the default value.    
			</p>
			<a name="unassignedtext" ></a>
			<h2>Unassigned Text</h2>
			<p>
			If there are calls of data type rules or terminal rules that do not reside in an assignment, 
			the serializer by default doesn't know which value to use for serialization.  
			</p>
			<p>
			Example:
			</p>
			<p>
			<div class="literallayout">
				<div class="incode">
					<p class="code">
						PluralRule:<br/>
						&nbsp;&nbsp;<span class="string">&apos;contents:&apos;</span>&nbsp;count=INT&nbsp;Plural;<br/>
						&nbsp;&nbsp;<br/>
						<span class="keyword">terminal</span>&nbsp;Plural:&nbsp;<br/>
						&nbsp;&nbsp;<span class="string">&apos;item&apos;</span>&nbsp;|&nbsp;<span class="string">&apos;items&apos;</span>;
					</p>
				</div>
			</div>
			</p>
			<p>
			Valid models for this example are <em>contents 1 item</em> or <em>contents 5 items</em>. However, it is not stored 
			in the semantic model whether the keyword <em>item</em> or <em>items</em> has been parsed. This is due to the fact 
			that the rule call <em>Plural</em> is unassigned. However, the <a href="100-serialization.php#parsetreeconstructor.php" title="Go to &quot;Parse Tree Constructor&quot;">parse tree constructor</a> 
			needs to decide which value to write during serialization. This decision can be be made by customizing 
			the <a class="jdoc" href="http://download.eclipse.org/modeling/tmf/xtext/javadoc/2.3/org/eclipse/xtext/parsetree/reconstr/ITokenSerializer.IValueSerializer.html" title="org.eclipse.xtext.parsetree.reconstr.ITokenSerializer.IValueSerializer">IValueSerializer.serializeUnassignedValue(EObject, RuleCall, INode)</abbr></a> <a class="srcLink" href="https://github.com/eclipse/xtext/blob/v2.2.0/plugins/org.eclipse.xtext/src/org/eclipse/xtext/parsetree/reconstr/ITokenSerializer.java" title="View Source Code" >(src)</a>.
			</p>
			<a name="crossreferenceserializer" ></a>
			<h2>Cross-Reference Serializer</h2>
			<p>
			The cross-reference serializer specifies which values are to be written to the textual representation 
			for cross-references. This behavior can be customized by implementing 
			<a class="jdoc" href="http://download.eclipse.org/modeling/tmf/xtext/javadoc/2.3/org/eclipse/xtext/parsetree/reconstr/ITokenSerializer.ICrossReferenceSerializer.html" title="org.eclipse.xtext.parsetree.reconstr.ITokenSerializer.ICrossReferenceSerializer">ITokenSerializer.ICrossReferenceSerializer</abbr></a> <a class="srcLink" href="https://github.com/eclipse/xtext/blob/v2.2.0/plugins/org.eclipse.xtext/src/org/eclipse/xtext/parsetree/reconstr/ITokenSerializer.java" title="View Source Code" >(src)</a>. 
			The default implementation delegates to various other services such as the <a class="jdoc" href="http://download.eclipse.org/modeling/tmf/xtext/javadoc/2.3/org/eclipse/xtext/scoping/IScopeProvider.html" title="org.eclipse.xtext.scoping.IScopeProvider">IScopeProvider</abbr></a> <a class="srcLink" href="https://github.com/eclipse/xtext/blob/v2.2.0/plugins/org.eclipse.xtext/src/org/eclipse/xtext/scoping/IScopeProvider.java" title="View Source Code" >(src)</a> or the 
			<a class="jdoc" href="http://download.eclipse.org/modeling/tmf/xtext/javadoc/2.3/org/eclipse/xtext/linking/impl/LinkingHelper.html" title="org.eclipse.xtext.linking.impl.LinkingHelper">LinkingHelper</abbr></a> <a class="srcLink" href="https://github.com/eclipse/xtext/blob/v2.2.0/plugins/org.eclipse.xtext/src/org/eclipse/xtext/linking/impl/LinkingHelper.java" title="View Source Code" >(src)</a> each of which may be the better place for customization.
			</p>
			<a name="hiddentokenmerger" ></a>
			<h2>Merge White Space</h2>
			<p>
			After the <a href="100-serialization.php#parsetreeconstructor.php" title="Go to &quot;Parse Tree Constructor&quot;">parse tree constructor</a> has done its job to create a stream of 
			tokens which are to be written to the textual representation, and the <a href="100-serialization.php#commentassociater.php" title="Go to &quot;Preserving Comments from the Node Model&quot;">comment associator</a> 
			has done its work, existing white space form the node model is merged into the stream. 
			</p>
			<p>
			The strategy is as follows: If two tokens follow each other in the stream and the corresponding 
			nodes in the node model follow each other as well, then the white space information in between is kept. 
			In all other cases it is up to the <a href="105-formatting.php" title="Go to &quot;Formatting (Pretty Printing)&quot;">formatter</a> to calculate new white space information. 
			</p>
			<a name="tokenstream" ></a>
			<h2>Token Stream</h2>
			<p>
			The <a href="100-serialization.php#parsetreeconstructor.php" title="Go to &quot;Parse Tree Constructor&quot;">parse tree constructor</a> and the <a href="105-formatting.php" title="Go to &quot;Formatting (Pretty Printing)&quot;">formatter</a> use an 
			<a class="jdoc" href="http://download.eclipse.org/modeling/tmf/xtext/javadoc/2.3/org/eclipse/xtext/parsetree/reconstr/ITokenStream.html" title="org.eclipse.xtext.parsetree.reconstr.ITokenStream">ITokenStream</abbr></a> <a class="srcLink" href="https://github.com/eclipse/xtext/blob/v2.2.0/plugins/org.eclipse.xtext/src/org/eclipse/xtext/parsetree/reconstr/ITokenStream.java" title="View Source Code" >(src)</a> for their output, and the 
			latter for its input as well. This allows for chaining the two components. Token streams can be converted to a <a class="jdoc" href="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/String.html" title="java.lang.String">String</abbr></a> 
			using the <a class="jdoc" href="http://download.eclipse.org/modeling/tmf/xtext/javadoc/2.3/org/eclipse/xtext/parsetree/reconstr/impl/TokenStringBuffer.html" title="org.eclipse.xtext.parsetree.reconstr.impl.TokenStringBuffer">TokenStringBuffer</abbr></a> <a class="srcLink" href="https://github.com/eclipse/xtext/blob/v2.2.0/plugins/org.eclipse.xtext/src/org/eclipse/xtext/parsetree/reconstr/impl/TokenStringBuffer.java" title="View Source Code" >(src)</a> and to 
			a <a class="jdoc" href="http://download.oracle.com/javase/1.5.0/docs/api/java/io/Writer.html" title="java.io.Writer">Writer</abbr></a> using the <a class="jdoc" href="http://download.eclipse.org/modeling/tmf/xtext/javadoc/2.3/org/eclipse/xtext/parsetree/reconstr/impl/WriterTokenStream.html" title="org.eclipse.xtext.parsetree.reconstr.impl.WriterTokenStream">WriterTokenStream</abbr></a> <a class="srcLink" href="https://github.com/eclipse/xtext/blob/v2.2.0/plugins/org.eclipse.xtext/src/org/eclipse/xtext/parsetree/reconstr/impl/WriterTokenStream.java" title="View Source Code" >(src)</a>.
			</p>
			<p>
			<div class="literallayout">
				<div class="incode">
					<p class="code">
						<span class="keyword">public</span>&nbsp;<span class="keyword">interface</span>&nbsp;ITokenStream&nbsp;{<br/>
						<br/>
						&nbsp;&nbsp;<span class="keyword">void</span>&nbsp;flush()&nbsp;<span class="keyword">throws</span>&nbsp;IOException;<br/>
						&nbsp;&nbsp;<span class="keyword">void</span>&nbsp;writeHidden(EObject&nbsp;grammarElement,&nbsp;String&nbsp;value);<br/>
						&nbsp;&nbsp;<span class="keyword">void</span>&nbsp;writeSemantic(EObject&nbsp;grammarElement,&nbsp;String&nbsp;value);<br/>
						}
					</p>
				</div>
			</div>
			</p>
		<div id="disqus_thread"></div>
		<script type="text/javascript" src="documentationRoot.js"></script>
		<script type="text/javascript">
		    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
		    var disqus_shortname = 'xtext'; // required: replace example with your forum shortname
		
		    // The following are highly recommended additional parameters. Remove the slashes in front to use.
		    var disqus_identifier = 'serialization';
		    var disqus_url = documentationRoot+'100-serialization.php';
		
		    /* * * DON'T EDIT BELOW THIS LINE * * */
		    (function() {
		        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
		        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
		    })();
		</script>
 		<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
	</div>
	<br style="clear:both;height:1em;">
